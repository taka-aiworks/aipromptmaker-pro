🎨 AI Prompt Maker - Google Apps Script連携 完全マニュアル【改訂版】
📖 目次

概要
事前準備
GAS側の設定
クライアント側の設定
機能の使い方
トラブルシューティング
よくある質問


🌟 概要
このGAS連携機能により、AI Prompt Makerで生成したCSVデータを自動的にGoogle Driveにスプレッドシート形式で保存できます。
✨ 主な機能

CSV自動変換: 学習データ・量産データをスプレッドシート形式で保存
データ整理: 連番順ソート、ヘッダー強調、メタデータ付与
フォルダ自動作成: Google Drive内に専用フォルダを自動生成
FormData対応: 大容量データの安全な送信
接続テスト: ping機能による動作確認


🚀 事前準備
必要なもの

Googleアカウント
インターネット接続
AI Prompt Makerの最新版

推定作業時間

初回設定: 約10-15分
日常使用: 設定後は自動動作


⚙️ GAS側の設定
ステップ1: Google Apps Scriptにアクセス

ブラウザで https://script.google.com/ を開く
Googleアカウントでログイン

ステップ2: 新しいプロジェクトを作成

「新しいプロジェクト」をクリック
プロジェクト名を「AI Prompt Maker - CSV変換」に変更（推奨）

ステップ3: コードの貼り付け

デフォルトのCode.gsをすべて削除
提供されたapm_csv_to_sheet.gsファイルの内容をすべてコピー&ペースト
Ctrl+S（またはCmd+S）で保存

重要: ファイル全体（約400行）を漏れなくコピーしてください。
ステップ4: 権限の確認

関数選択で doGet または doPost を選択
▶️ 実行ボタンをクリック
初回実行時の承認画面：

「権限を確認」→「詳細」→「AI Prompt Maker - CSV変換（安全ではないページ）に移動」
「許可」をクリック


必要な権限を全て許可

必要な権限:

Google Driveへのアクセス
スプレッドシートの作成・編集
外部からのHTTPリクエスト受信

ステップ5: Webアプリとしてデプロイ

右上の「デプロイ」→「新しいデプロイ」をクリック
「種類を選択」で ⚙️ アイコン→「ウェブアプリ」を選択
設定項目：

説明: 「AI Prompt Maker CSV変換」（任意）
実行者: 「自分」を選択 ⚠️重要
アクセスできるユーザー: 「全員」を選択 ⚠️重要


「デプロイ」をクリック
WebアプリURLをコピー 📋（このURLが重要です！）

URLの例：
https://script.google.com/macros/s/AKfycbx54ytwe4gEqbleG33b.../exec
⚠️ 注意: URLは必ず /exec で終わることを確認してください。

💻 クライアント側の設定
ステップ1: AI Prompt Makerを開く
ブラウザでAI Prompt Makerにアクセスします。
ステップ2: 設定画面を開く
「⚙️ 設定」タブをクリックします。
ステップ3: GAS連携設定
「☁️ Google Apps Script連携」セクションで以下を設定：

GAS WebアプリURL:

先ほどコピーしたURLを貼り付け
形式: https://script.google.com/macros/s/[長いID]/exec
⚠️ /execで終わることを必ず確認


認証トークン:

通常は空欄のままでOK
セキュリティを強化したい場合のみ任意の文字列を設定


自動バックアップ:

推奨設定: ✅ 有効
間隔: 24時間推奨



ステップ4: 設定の保存と接続テスト

「💾 設定保存」をクリック
「🔌 接続テスト」をクリック
成功メッセージが表示されればOK！ ✅

成功例：
✅ 接続成功!
📡 接続成功 - 2025/1/15 14:30:25
⏰ 2025-01-15T05:30:25.123Z
失敗例：
❌ 接続失敗
🔍 スクリプトの読み込みに失敗しました
💡 GAS URLとデプロイ設定を確認してください

🎯 機能の使い方
📊 CSV自動保存
学習データの保存

AI Prompt Makerで学習データを生成（「🧠 学習用データ生成」ボタン）
「☁️ 学習」ボタンをクリック
自動的にGoogle Driveに保存される

量産データの保存

量産データを生成（「📦 量産データ生成」ボタン）
「☁️ 量産」ボタンをクリック
Google Driveに自動保存

📁 保存先の確認

Google Driveを開く
以下のフォルダが自動作成されています：

AI_Prompt_Maker_Data: メインフォルダ

Spreadsheets: スプレッドシートファイル





📋 スプレッドシートの内容
保存されるスプレッドシートには以下が含まれます：
データシート:

連番順にソートされたプロンプトデータ
ヘッダー行（太字、背景色付き）
列: no, seed, prompt, negative

メタデータシート:

作成日時、データタイプ、行数
キャラクター名、データサイズ
処理完了情報

🔄 手動バックアップ
設定画面で「☁️ 手動バックアップ」ボタンをクリックすると、現在の設定を Google Drive にバックアップできます。

🛠️ トラブルシューティング
❌ よくあるエラーと解決方法
1. 「GAS URLが設定されていません」
原因: WebアプリURLが未設定または間違っている
解決:

GASでデプロイしたURLを正確にコピー&ペースト
URLがhttps://script.google.com/macros/s/で始まり/execで終わることを確認

2. 「接続失敗: スクリプトの読み込みに失敗しました」
原因: GAS側のデプロイ設定が間違っている
解決:

デプロイ設定で「実行者: 自分」「アクセス: 全員」を確認
新しいバージョンでデプロイし直す
ブラウザのキャッシュをクリア

3. 「CSVデータまたはファイル名が不足しています」
原因: データ生成前にクラウド保存を実行した
解決:

先に学習データまたは量産データを生成する
生成完了後にクラウド保存ボタンをクリック

4. 「権限エラー」
原因: Google Driveアクセス権限が不足
解決:

GASエディタで再度権限確認を実行
必要な権限をすべて許可
ブラウザでGoogleアカウントに確実にログイン

5. 「フォルダ作成エラー」
原因: Google Driveの容量不足またはアクセス権限
解決:

Google Driveの容量を確認（15GB制限）
不要なファイルを削除して容量を確保
しばらく待ってから再試行

🔍 詳細なデバッグ方法
GAS側のログ確認

GASエディタで「実行数」→「実行トランスクリプト」をクリック
エラーメッセージや実行ログを確認
console.log出力でデータ受信状況を確認

ブラウザのコンソール確認

F12キーでデベロッパーツールを開く
Consoleタブでエラーメッセージを確認
Network タブで通信状況を確認
赤いエラーメッセージがあれば詳細を確認

🔄 完全リセット手順
問題が解決しない場合の最終手段：

GAS側:

新しいプロジェクトを作成
コードを再度コピー&ペースト
権限を再設定
新しいWebアプリとしてデプロイ


クライアント側:

設定画面で「🗑️ リセット」ボタンをクリック
新しいGAS URLを設定
接続テストを実行




❓ よくある質問
Q1. 料金はかかりますか？
A: 基本的に無料です。Google Driveの容量制限（15GB）内であれば追加料金はありません。大量のデータを保存する場合は Google One の契約を検討してください。
Q2. データの安全性は？
A: データはあなたのGoogle Driveに保存され、Googleのセキュリティ基準で保護されます。第三者がアクセスすることはできません。
Q3. 複数のデバイスで使えますか？
A: はい。同じGoogleアカウントであれば、異なるデバイスからも同じデータにアクセスできます。
Q4. 過去のデータを削除したい
A: Google DriveでAI_Prompt_Maker_Dataフォルダを開き、不要なファイルを手動で削除してください。
Q5. 他の人とデータを共有したい
A: Google Driveの共有機能を使って、フォルダまたは個別ファイルを共有できます。
Q6. 大容量データでも送信できますか？
A: はい。システムが自動的にFormData方式に切り替えて大容量データに対応します。ただし、極端に大きなデータ（1万行以上）の場合は分割して送信することを推奨します。
Q7. スプレッドシートが文字化けする
A:

文字エンコーディングの問題の可能性があります
ブラウザを再起動してから再試行
それでも解決しない場合はGASプロジェクトを再作成

Q8. 接続は成功するがデータが保存されない
A:

Google Driveの容量を確認
GAS実行ログでエラーメッセージを確認
データサイズが大きすぎる場合は分割して送信

Q9. エラーが続く場合は？
A: 以下の順序で確認してください：

インターネット接続を確認
Googleアカウントに正しくログインしているか確認
ブラウザを再起動
GASのデプロイURLを再確認
設定をリセットして再設定
最終手段として新しいGASプロジェクトを作成


🔧 高度な設定
セキュリティ強化（認証トークン）
より安全に使用したい場合、認証トークンを設定できます：

GAS側で設定: コード内の認証処理部分でトークンを確認
クライアント側で同じトークンを設定: 設定画面の認証トークン欄に入力

データ保存形式のカスタマイズ

ファイル名は自動で データタイプ_キャラクター名_日時 形式で生成
スプレッドシートには自動的にメタデータシートが追加
ヘッダー行は太字で背景色が適用


📞 サポート
問題が解決しない場合

エラーメッセージの詳細をコピー
実行した手順を整理
ブラウザとOSの情報を確認
GAS実行ログのスクリーンショットを取得

アップデート情報
機能追加や改善は随時実施されます。新しいバージョンがリリースされた場合：

GAS側のコードを最新版に更新
新しいバージョンでデプロイ
クライアント側のコードも更新（必要に応じて）


🎉 まとめ
この連携機能により、AI Prompt Makerで生成したデータが自動的にGoogle Driveに整理保存され、データの管理と分析が格段に便利になります。
設定は一度だけ行えば、その後は自動的に動作します。生成したプロンプトデータを安全にクラウド保存して、より効率的なAI活用を実現してください！
Happy Prompting! 🚀

📋 チェックリスト
設定完了の確認にご利用ください：

 GASプロジェクトを作成
 コード全体をコピー&ペースト
 権限を正しく設定
 Webアプリとしてデプロイ（実行者: 自分、アクセス: 全員）
 WebアプリURLをコピー
 AI Prompt Makerの設定画面でURL設定
 接続テストに成功
 実際のデータ送信に成功
 Google Driveにフォルダとファイルが作成されることを確認

すべてチェックできれば設定完了です！🎊再試行Claudeは間違えることがあります。回答内容を必ずご確認ください。
