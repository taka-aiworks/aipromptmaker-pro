AI プロンプトメーカー Pro – 利用マニュアル

このマニュアルでは、ローカルでの使い方と、Google Apps Script（GAS）経由でスプレッドシート保存する手順を解説します。
ブラウザ（Chrome / Edge の最新）で動作します。

⸻

1. 同梱物と動作環境

フォルダ構成

/（配布ZIPルート）
├─ index.html
├─ app.js
├─ styles.css
├─ apm_csv_to_sheet.gs     ← ★ 追加
├─ dict/
│   ├─ default_sfw.json
│   └─ default_nsfw.json
└─ image/
    ├─ favicon.ico
    └─ ogp.png

推奨環境
	•	OS：Windows / macOS / iPadOS（最新版推奨）
	•	ブラウザ：Chrome / Edge（最新版）
	•	追加要件：
	•	ローカル保存のみ → インターネット不要
	•	GASへ保存 → Google アカウント + インターネット接続が必要

⸻

2. クイックスタート（ローカルでの基本操作）
	1.	index.html をブラウザで開く。
	2.	画面上部のタブから用途を選択：
	•	基本情報：キャラの年齢/性別/体型/身長、髪/瞳/肌の色、髪型・目の形、服（トップ/ボトム/スカート/ワンピース/靴）を設定。
	•	撮影モード：背景/ポーズ/構図/視点/表情/ライティング/アクセを “各1つ” 選んで1枚分のプロンプトを作成。
	•	学習モード：LoRA向けに “複数行” をまとめて生成。Captionや1枚テスト付き。
	•	量産モード：背景・表情などを “複数選択” → ランダム組合せで多数行を一括生成。
	•	設定：GASのURL・トークン、辞書入出力、キャッシュ初期化など。
	3.	右側の出力枠から必要に応じてコピー：
	•	All（まとめて）/ Prompt / Negative / Caption（学習モードのみ）
	4.	必要なら CSV保存（ローカル） または クラウド保存（GAS） を実行。

NSFW は切替可能。成人モデルでのみ使用してください。

⸻

3. 各モードの使い方（要点）

3-1. 基本情報
	•	キャラのコア属性（年齢/性別/体型/身長・髪型/目の形・髪/瞳/肌の色）を固定。
	•	服は セパレート（トップ+ボトム/スカート）とワンピースを切替。
	•	色指定はON/OFFでき、色ホイール＋数値タグで出力を安定化。
	•	固定タグ/固定ネガティブもここで設定。

3-2. 撮影モード（1枚出力）
	•	背景/ポーズ/構図/視点/表情/ライティング/アクセサリーを各1つ選ぶ。
	•	画面右の出力に Prompt / Negative を生成。Copy でクリップボードへ。

3-3. 学習モード（複数行）
	•	LoRA学習向けの 安定したベース + 軽いバリエーションで複数行を生成。
	•	1枚テスト（Prompt/Neg/Caption）とCaption一括生成あり。
	•	CSV保存（ローカル） または クラウド保存（GAS） が可能。

3-4. 量産モード（多数行）
	•	背景・表情などを複数選び、ランダムに組合せて一気に展開。
	•	Seedは固定 or 微揺らぎ（キャラ名 + 行番号）を選択可。
	•	ボトム⇔スカートの補完ONで、未選択側を自動補完。
	•	CSV/クラウド保存に対応。

3-5. 単語モード
	•	辞書カテゴリごとにタグを選び、下部テーブルに蓄積 → コピー。
	•	スプシや外部辞書の棚卸しに便利。

3-6. 設定
	•	辞書のインポート/エクスポート
	•	GASの URL / トークン
	•	キャッシュ初期化（辞書再読込が必要なとき）

⸻

4. GAS（スプレッドシート保存）の設定

ここを設定すると、学習モード/量産モードの出力を Google スプレッドシートに保存できます。

4-1. GAS スクリプトを作成
	1.	ブラウザで Google Apps Script を開く（Googleアカウントにログイン）。
        [https://script.google.com/home?utm_source=chatgpt.com&pli=1](https://script.google.com/?utm_source=chatgpt.com)
	2.	新しいプロジェクトを作成。
	3.	エディタの Code.gs に、フォルダ内の「apm_csv_to_sheet.gs」コードを貼り付けて保存。
	•	ファイル名：apm_csv_to_sheet.gs（推奨）
	•	プロジェクト名：APM Sheet Uploader (CSV→SS)

セキュリティ強化案：ハードコードではなく、TOKEN を スクリプトプロパティから取得

4-2. Web アプリとしてデプロイ
	1.	GAS 画面の右上「デプロイ」＞「新しいデプロイ」。
	2.	種類：ウェブアプリ
	3.	実行するユーザー：自分
	4.	アクセスできるユーザー：全員（匿名含む）（フロントから直接POSTするため）
	5.	デプロイすると、ウェブアプリの URL（.../exec）が発行されます。
	•	この URL を後でアプリの「設定」画面に貼り付けます。
	6.	初回のみ Google から権限確認ダイアログが出るので許可してください。

5. アプリ側（設定 → クラウド保存）
	1.	アプリの設定タブを開く。
	2.	GAS URL（.../exec）を貼り付ける。
	3.	トークンを使う場合は、設定欄に入力（?token=... で付与されます）。
	4.	学習モードまたは量産モードの出力画面で、クラウド保存をクリック。
	•	正常に保存されると、Googleドライブに APM_CSV フォルダが作成され、その中にスプレッドシートが作成されます。
	•	シート名は filename（拡張子 .csv を除いたベース名）。
例）
learn_{charName}_{YYYYMMDD}_{HHmm}.csv
prod_{charName}_{YYYYMMDD}_{HHmm}.csv

 6. よくある質問（FAQ）

Q1. 「unauthorized」が返る
	•	TOKEN を設定しているのに、フロントから ?token=... が付いていない場合に発生。
	•	アプリの設定にトークンを入れたか確認。GAS 側トークンと一致しているかも確認。

Q2. 保存したのにスプレッドシートが見当たらない
	•	Googleドライブの APM_CSV フォルダを確認。見つからなければフォルダ名を検索。
	•	別の Google アカウントでログインしていないかチェック。

Q3. CORS のエラーが出る
	•	このコードは fetch の標準 JSON POST で動作します。もし開発環境に依存して CORS 警告が出る場合は、レスポンスを読まない実装（mode:"no-cors"）に変更可。ただし結果は取得できなくなるため、UI 上は「保存要求を送信しました」程度のトーストにする。

Q4. 文字化けする
	•	Utilities.parseCsv は UTF-8 前提。CSV生成時に値を文字列化し、改行/カンマを適切にエスケープしてください（アプリ側で対応済み）。

Q5. plain_background と beach が両方入ることがある
	•	本ツールは**カテゴリ（背景/シチュ）**が異なる要素の “意味的重複” を許容しています。
	•	出力方針はユーザー判断でOK。必要なら辞書で統合・分離してください。

⸻

7. ライセンス / 利用条件（重要）
	•	本ツールは 購入者本人のみ 利用可能です。
	•	再配布・再販売・転売・共有、改変したものを含む 二次配布は禁止します。
	•	ツールを利用した代理販売/サービス提供は不可。
	•	自身の制作物に本ツールで生成したプロンプトを使うこと（商用含む）は可能です。
	•	利用に伴ういかなる損害にも作者は責任を負いません。各プラットフォーム規約・法令に従ってご利用ください。
	•	NSFW は成人のみを対象とし、未成年・未成年に見える表現との併用は禁止です。

⸻

8. 更新予定 / サポート
	•	予定：辞書のカスタム機能、カテゴリ拡張（小道具/シチュの細分化）、出力フォーマット追加。
	•	サポート：販売ページのメッセージ機能から不具合・要望をお知らせください。
	•	対応範囲：動作不具合/使い方の簡単な質問
	•	非対応：個別機能の追加開発、各AIモデル固有の生成差異・結果品質の保証

